var U=Object.defineProperty;var K=(a,t,i)=>t in a?U(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var S=(a,t,i)=>(K(a,typeof t!="symbol"?t+"":t,i),i),V=(a,t,i)=>{if(!t.has(a))throw TypeError("Cannot "+i)};var d=(a,t,i)=>(V(a,t,"read from private field"),i?i.call(a):t.get(a)),E=(a,t,i)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,i)},q=(a,t,i,e)=>(V(a,t,"write to private field"),e?e.call(a,i):t.set(a,i),i);var N=(a,t,i)=>(V(a,t,"access private method"),i);mw.require("editor.js");mw.require("css_parser.js");const J=function(){var a=document.querySelector("#mw-live-edit-editor"),t=function(){var l={};this.on=function(h,m){l[h]?l[h].push(m):l[h]=[m]},this.dispatch=function(h,m){l[h]&&l[h].forEach(function(c){c.call(this,m)})},this.provide=function(h){this.dispatch("change",h.map(function(m){return{label:m,value:m}}))}},i=new t;window.fontFamilyProvider=i;const e=mw.app.get("canvas").getFrame();e.contentWindow.fontFamilyProvider=i;const s=mw.Editor({document:e.contentWindow.document,executionDocument:e.contentWindow.document,actionWindow:e.contentWindow,element:a,mode:"document",regions:".edit",skin:"le2",editMode:"liveedit",scopeColor:"white",controls:[[{group:{icon:"mdi mdi-format-title",controls:["format","lineHeight"]}},{group:{controller:"bold",controls:["italic","underline","strikeThrough","removeFormat"]}},"fontSelector","fontSize",{group:{controller:"alignLeft",controls:["alignLeft","alignCenter","alignRight","alignJustify"]}},{group:{controller:"ul",controls:["ol"]}},"image",{group:{controller:"link",controls:["unlink"]}},{group:{controller:"textColor",controls:["textBackgroundColor"]}}]],smallEditorPositionX:"center",smallEditorSkin:"lite",interactionControls:[],id:"live-edit-wysiwyg-editor",minHeight:250,maxHeight:"70vh",state:mw.liveEditState,fontFamilyProvider:i});var n=document.getElementById("toolbar-undo"),o=document.getElementById("toolbar-redo");s.state.on("record",function(){o.disabled=!s.state.hasPrev,n.disabled=!s.state.hasNext}),s.state.on("change",function(){o.disabled=!s.state.hasPrev,n.disabled=!s.state.hasNext}),n&&n.addEventListener("click",function(){s.state.undo()}),o&&o.addEventListener("click",function(){s.state.redo()}),a.innerHTML="",a.appendChild(s.wrapper);var r=s.storage.get(s.settings.id+"-small-editor-pinned");typeof r>"u"&&typeof s.smallEditorApi<"u"&&s.smallEditorApi.pin(),mw.app.register("richTextEditor",s),mw.app.register("richTextEditorAPI",s.api)};var v;class j{constructor(){E(this,v,{})}on(t,i){d(this,v)[t]?d(this,v)[t].push(i):d(this,v)[t]=[i]}off(t,i){if(d(this,v)[t])if(typeof i=="function"){const e=d(this,v)[t].indexOf(i);if(e===-1)return;d(this,v)[t].splice(e,1)}else d(this,v)[t]=[]}dispatch(t,i){d(this,v)[t]&&d(this,v)[t].forEach(function(e){e.call(this,i)})}}v=new WeakMap;var p;class tt extends j{constructor(){super();E(this,p,null)}go(i){d(this,p)&&d(this,p).ownerDocument&&d(this,p).contentWindow&&(d(this,p).src=i)}refresh(){d(this,p)&&d(this,p).ownerDocument&&d(this,p).contentWindow&&d(this,p).contentWindow.location.reload()}getFrame(){if(d(this,p)&&d(this,p).ownerDocument)return d(this,p)}getWindow(){if(d(this,p)&&d(this,p).ownerDocument)return d(this,p).contentWindow}getDocument(){if(d(this,p)&&d(this,p).ownerDocument)return d(this,p).contentWindow.document}mount(i){mw.spinner({element:i,size:52,decorate:!0});const e=document.createElement("iframe");e.src=`${mw.settings.site_url}?editmode=n`,e.frameBorder=0,e.id="live-editor-frame",e.referrerPolicy="no-referrer",q(this,p,e),i.innerHTML="",i.appendChild(e),e.addEventListener("load",s=>{this.dispatch("liveEditCanvasLoaded"),mw.spinner({element:i}).remove()})}}p=new WeakMap;class y{static extend(){const t={};let i=!1,e=0;const s=arguments.length;Object.prototype.toString.call(arguments[0])==="[object Boolean]"&&(i=arguments[0],e++);const n=function(o){for(const r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i&&Object.prototype.toString.call(o[r])==="[object Object]"?t[r]=y.extend(!0,t[r],o[r]):t[r]=o[r])};for(;e<s;e++){const o=arguments[e];n(o)}return t}}let M;const O=document.documentElement;O.matches?M="matches":O.matchesSelector?M="matchesSelector":O.mozMatchesSelector?M="mozMatchesSelector":O.webkitMatchesSelector&&(M="webkitMatchesSelector");class b{static fragment(){return this._fragment||(this._fragment=document.createElement("div"),this._fragment.style.visibility="hidden",this._fragment.style.position="absolute",this._fragment.style.width="1px",this._fragment.style.height="1px",document.body.appendChild(this._fragment)),this._fragment}static matches(t,i){return t[M](i)}static isBlockLevel(t){if(!t||t.nodeType===3)return!1;var i=t.nodeName;if(typeof this._isBlockCache[i]<"u")return this._isBlockCache[i];var e=document.createElement(i);return this.fragment().appendChild(e),this._isBlockCache[i]=getComputedStyle(e).display==="block",this.fragment().removeChild(e),this._isBlockCache[i]}static firstBlockLevel(t){for(;t&&t.classList;){if(this.isBlockLevel(t))return t;t=t.parentNode}}static firstWithBackgroundImage(t){if(!t)return null;for(;t&&t.nodeName!=="BODY";){if(t.style.backgroundImage)return t;t=t.parentElement}return null}static hasAnyOfClassesOnNodeOrParent(t,i){for(;t&&t.nodeName!=="BODY";){let e=0,s=i.length;for(;e<s;e++)if(t.classList.contains(i[e]))return!0;t=t.parentElement}return!1}static hasParentsWithClass(t,i){if(t){for(var e=t.parentNode;e&&e.nodeName!=="BODY";){if(e.classList.contains(i))return!0;e=e.parentNode}return!1}}static hasParentWithId(t,i){if(t){for(var e=t.parentNode;e&&e.nodeName!=="BODY";){if(e.id===i)return!0;e=e.parentNode}return!1}}static firstWithAyOfClassesOnNodeOrParent(t,i){for(;t&&t.nodeName!=="BODY";){let e=0,s=i.length;for(;e<s;e++)if(t.classList.contains(i[e]))return t;t=t.parentElement}return null}static firstParentOrCurrentWithTag(t,i){if(!(!t||!i)){i=typeof i!="string"?i:[i];for(var e=t;e&&e.nodeName!=="BODY";){if(i.indexOf(e.nodeName.toLowerCase())!==-1)return e;e=e.parentNode}return!1}}static index(t,i,e){e=e||t.tagName.toLowerCase(),i=i||t.parentNode;var s;i.constructor===[].constructor?s=i:s=i.querySelectorAll(e);for(var n=0,o=s.length;n<o;n++)if(t===s[n])return n}static firstParentOrCurrentWithClass(t,i){if(!t)return!1;for(var e=t;e&&e.nodeName!=="BODY";){if(e.classList.contains(i))return e;e=e.parentNode}return!1}static firstParentOrCurrent(t,i){if(!t)return!1;for(var e=t;e&&e.nodeName!=="BODY";){if(e.matches(i))return e;e=e.parentNode}return!1}static firstParentOrCurrentWithAnyOfClasses(t,i){if(!t)return!1;for(var e=t;e&&e.nodeName!=="BODY";){if(!e)return!1;if(this.hasAnyOfClasses(e,i))return e;e=e.parentNode}return!1}static parentsOrCurrentOrderMatchOrOnlyFirst(t,i){let e=t;for(;e&&e.nodeName!=="BODY";){const s=e.classList.contains(i[0]),n=e.classList.contains(i[1]);if(s&&n)return!1;if(s)return!0;if(n)return!1;e=e.parentNode}return!1}static parentsOrCurrentOrderMatchOrOnlyFirstOrNone(t,i){let e=t;for(;e&&e.nodeName!=="BODY";){const s=e.classList.contains(i[0]),n=e.classList.contains(i[1]);if(s&&n)return!1;if(s)return!0;if(n)return!1;e=e.parentNode}return!0}static hasAnyOfClasses(t,i){if(!t)return;let e=0,s=i.length;for(;e<s;e++)if(t.classList.contains(i[e]))return!0;return!1}static offset(t){if(t){var i=t.getBoundingClientRect(),e={top:i.top,left:i.left,width:i.width,height:i.height,bottom:i.bottom,right:i.right};return e.top+=t.ownerDocument.defaultView.scrollY,e.bottom+=t.ownerDocument.defaultView.scrollY,e.left+=t.ownerDocument.defaultView.scrollX,e.right+=t.ownerDocument.defaultView.scrollX,e}}static parentsOrder(t,i){for(var e=[],s={},n=i.length,o=0,r=-1;o<n;o++)s[i[o]]=-1;if(!t)return s;for(var l=t.parentNode;l&&l.nodeName!=="BODY";){for(r++,o=0;o<n;o++)l.classList.contains(i[o])&&e.indexOf(i[o])===-1&&(s[i[o]]=r,e.push(i[o]));l=l.parentNode}return s}}S(b,"_isBlockCache",{}),S(b,"_fragment");class et{constructor(t){this.settings=t,this.tools=b}isRow(t){return t.classList.contains(this.settings.rowClass)}isModule(t){return t.classList.contains(this.settings.moduleClass)&&t.dataset.type!=="layouts"}isLayout(t){return t.classList.contains(this.settings.moduleClass)&&t.dataset.type==="layouts"}isInLayout(t){if(!t)return!1;for(t=t.parentNode;t&&t!==this.settings.document.body;){if(t.classList.contains(this.settings.moduleClass)&&t.dataset.type==="layouts")return!0;t=t.parentNode}}isElement(t){return t.classList.contains(this.settings.elementClass)}isEmptyElement(t){return t.classList.contains(this.settings.emptyElementClass)}isEdit(t){return t.classList.contains(this.settings.editClass)}isInEdit(t){var i=[this.settings.editClass,this.settings.moduleClass];return this.tools.parentsOrCurrentOrderMatchOrOnlyFirst(t.parentNode,i)}isEditOrInEdit(t){return this.isEdit(t)||this.isInEdit(t)}isPlainText(t){return t.classList.contains(this.settings.plainElementClass)}getType(t){if(this.isEdit(t))return"edit";if(this.isElement(t))return"element";if(this.isModule(t))return"module";if(this.isLayout(t))return"layout"}}class $ extends et{constructor(t){super(t),this.settings=t,this._tagsCanAccept=["DIV","ARTICLE","ASIDE","FOOTER","HEADER","MAIN","SECTION","DD","LI","TD","FORM"],this.init()}isConfigurable(t){return this.isElement(t)||this.isModule(t)||this.isRow(t)}isEditableLayout(t){return this.this.isLayout(t)&&this.isInEdit(t)}canMoveModule(t){return this.isModule(t)&&this.isInEdit(t)}canAcceptByClass(t){return this.tools.hasAnyOfClasses(t,this.dropableElements())}canAcceptByTag(t){return!t||t.nodeType!==1?!1:this._tagsCanAccept.indexOf(t.nodeName)!==-1}allowDrop(t){return this.tools.parentsOrCurrentOrderMatchOrOnlyFirstOrNone(t,[this.settings.allowDrop,this.settings.nodrop])}canInsertBeforeOrAfter(t){return this.canAccept(t.parentNode)}canAccept(t){return!!(this.canAcceptByClass(t)&&this.isEditOrInEdit(t)&&this.allowDrop(t))}canReceiveElements(t){return this.isEdit(t)&&this.canAcceptByTag(t)}dropableElements(){return this._dropableElements}getIteractionTarget(t){return this.tools.firstWithAyOfClassesOnNodeOrParent(t,[this.settings.elementClass,this.settings.editClass,this.settings.moduleClass])}getTarget(t,i){const e=this.getIteractionTarget(t);if(!e||!this.isEditOrInEdit(t)||!this.allowDrop(t))return null;const s={target:e,canInsert:!1,beforeAfter:!1};var n=this.settings.strictLayouts&&this.isLayout(i),o=this.settings.strict&&!this.isLayout(i)&&!this.isInLayout(e);if(o)return null;if(this.isEdit(e))s.canInsert=!n;else if(this.isElement(e)&&!n)this.canAcceptByTag(e)&&(s.canInsert=!n),s.beforeAfter=!0;else if(this.isModule(e)&&!n)if(this.canInsertBeforeOrAfter(e))s.beforeAfter=!0;else return null;else if(this.isLayout(e))if(this.canInsertBeforeOrAfter(e))s.beforeAfter=!0;else return null;return s}init(){this._dropableElements=[this.settings.elementClass,this.settings.cloneableClass,this.settings.editClass,this.settings.moduleClass,this.settings.colClass,this.settings.allowDrop]}}let it=-1;const st=(a,t)=>{if(!a||!t)return!1;const i=t.target;if(!i||i.nodeType!==1)return!1;a.pageX;const e=a.pageY,s=b.offset(i),n={},o=15;if(it===e||!t||!t.canInsert&&!t.beforeAfter)return!1;if(t.canInsert&&t.beforeAfter)if(e>=s.top-o&&e<=s.top+o)n.position="top",n.action="before";else if(e>=s.top+o&&e<=s.top+s.height/2)n.position="top",n.action="prepend";else if(e>=s.top+s.height/2&&e<=s.bottom-o)n.position="bottom",n.action="append";else if(e>=s.top+s.height/2&&e>=s.bottom-o)n.position="bottom",n.action="after";else return!1;else if(t.beforeAfter)if(e>=s.top-o&&e<=s.top+s.height/2)n.position="top",n.action="before";else if(e>=s.top+s.height/2&&e<=s.bottom+o)n.position="bottom",n.action="after";else return!1;else if(t.canInsert)if(e>=s.top-o&&e<=s.top+s.height/2)n.position="top",n.action="prepend";else if(e>=s.top+s.height/2&&e<=s.bottom+o)n.position="bottom",n.action="append";else return!1;return n};var _=function(a,t){var i=this;this.isMWElement=!0,this.toggle=function(){this.css("display",this.css("display")==="none"?"block":"none")},this._active=function(){return this.nodes[this.nodes.length-1]},this.getDocument=function(){return this._active().ownerDocument},this.getWindow=function(){return this.getDocument().defaultView},this.get=function(s,n){this.nodes=(n||document).querySelectorAll(s)},this.each=function(s){if(this.nodes)for(var n=0;n<this.nodes.length;n++)s.call(this.nodes[n],n);else this.node&&s.call(this.node,0);return this},this.encapsulate=function(){};var e=function(s,n){s&&(Array.isArray(s)?s.forEach(function(o){e(o,n)}):s instanceof _?n.append(s):typeof s=="object"&&n.append(new _(s)))};this.create=function(){var s=this.document.createElement(this.settings.tag);if(this.node=s,this.settings.encapsulate===!0){var n=this.settings.encapsulate===!0?"open":this.settings.encapsulate;s.attachShadow({mode:n})}this.nodes=[s],this.settings.content&&e(this.settings.content,this)},this._specialProps=function(s,n){if(s==="tooltip")return this.node.dataset[s]=n,!0},this.setProps=function(){for(var s in this.settings.props)if(s==="dataset")for(var n in this.settings.props[s])this.node.dataset[n]=this.settings.props[s][n];else if(s==="style")for(var o in this.settings.props[s])this.node.style[o]=this.settings.props[s][o];else{var r=this.settings.props[s];this._specialProps(s,r)||(this.node[s]=r)}},this.__={cssNumber:["animationIterationCount","columnCount","fillOpacity","flexGrow","flexShrink","fontWeight","gridArea","gridColumn","gridColumnEnd","gridColumnStart","gridRow","gridRowEnd","gridRowStart","lineHeight","opacity","order","orphans","widows","zIndex","zoom"]},this._normalizeCSSValue=function(s,n){return typeof n=="number"&&this.__.cssNumber.indexOf(s)===-1&&(n=n+"px"),n},this.css=function(s,n){if(typeof s=="string")if(typeof n<"u"){var o=this._normalizeCSSValue(s,n);this.each(function(){this.style[s]=o})}else return this.document.defaultView.getComputedStyle(this.node)[s];if(typeof s=="object")for(var r in s)this.each(function(){this.style[r]=i._normalizeCSSValue(r,s[r])});return this},this.dataset=function(s,n){return typeof n>"u"?this._active()[s]:(this.each(function(){this.dataset[s]=n}),this)},this.attr=function(s,n){return typeof n>"u"?this._active()[s]:(this.each(function(){this.setAttribute(s,n)}),this)},this.val=function(s){return typeof s>"u"?this._active().value:(this.each(function(){this.value=s}),this)},this.prop=function(s,n){var o=this._active();return typeof n>"u"?o[s]:(o[s]!==n&&(o[s]=n,this.trigger("propChange",[s,n])),this)},this.hide=function(){return this.each(function(){this.style.display="none"})},this.show=function(){return this.each(function(){this.style.display=""})},this.find=function(s){var n=mw.element("#r"+new Date().getTime());return this.each(function(){for(var o=this.querySelectorAll(s),r=0;r<o.length;r++)n.nodes.indexOf(o[r])===-1&&n.nodes.push(o[r])}),n},this.addClass=function(s){return s=s.trim().split(" "),this.each(function(){var n=this;s.forEach(function(o){n.classList.add(o)})})},this.toggleClass=function(s){return this.each(function(){this.classList.toggle(s.trim())})},this.removeClass=function(s){var n=Array.isArray(s);if(n)return this.each(function(){for(var r=0,l=s.length;r<l;r++)this.classList.remove(s[r])});s=s.trim();var o=s.split(" ");return o.length>1?this.removeClass(o):this.each(function(){this.classList.remove(s)})},this.remove=function(){return this.each(function(){this.remove()})},this.empty=function(){return this.html("")},this.html=function(s){return typeof s>"u"?this._active().innerHTML:this.each(function(){this.innerHTML=s})},this.text=function(s,n){if(typeof s>"u")return this.node.textContent;typeof n>"u"&&(n=!0),n&&(s=this.document.createRange().createContextualFragment(s).textContent),this.node.innerHTML=s},this._asdom=function(s){return typeof s=="string"?this.document.createRange().createContextualFragment(s):s.node?s.node:s.nodes?s.nodes[s.nodes.length-1]:s},this.offset=function(){var s=this._active(),n=this.getWindow(),o=s.getBoundingClientRect();return o.offsetTop=o.top+n.pageYOffset,o.offsetBottom=o.bottom+n.pageYOffset,o.offsetLeft=o.left+n.pageXOffset,o},this.width=function(s){return s?this.css("width",s):this._active().offsetWidth},this.height=function(s){return s?this.css("height",s):this._active().offsetHeight},this.parent=function(){return mw.element(this._active().parentNode)},this.parents=function(s){s=s||"*";var n=this._active(),o=n.parentElement,r=mw.element();for(r.nodes=[];o;)o.matches(s)&&r.nodes.push(o),o=o.parentElement;return r},this.append=function(s){return s&&this.each(function(){this.append(i._asdom(s))}),this},this.before=function(s){return s&&this.each(function(){this.parentNode&&this.parentNode.insertBefore(i._asdom(s),this)}),this},this.after=function(s){s&&this.each(function(){this.parentNode&&this.parentNode.insertBefore(i._asdom(s),this.nextSibling)})},this.prepend=function(s){return s&&this.each(function(){this.prepend(i._asdom(s))}),this},this._disabled=!1,Object.defineProperty(this,"disabled",{get:function(){return this._disabled},set:function(s){this._disabled=s,this.node.disabled=this._disabled,this.node.dataset.disabled=this._disabled}}),this.trigger=function(s,n){return n=n||{},this.each(function(){this.dispatchEvent(new CustomEvent(s,{detail:n,cancelable:!0,bubbles:!0})),i._on[s]&&i._on[s].forEach(function(o){o.call(this,s,n)})}),this},this.get=function(s){return this.nodes[s]},this.wrap=function(s){var n=F(s);this.before(n),n.append(this)},this._on={},this.on=function(s,n){return s=s.trim().split(" "),s.forEach(function(o){i._on[o]||(i._on[o]=[]),i._on[o].push(n),i.each(function(){this.addEventListener(o,n,!1)})}),this},this.init=function(){if(this.nodes=[],this.root=t||document,this.root instanceof _&&(this.root=this.root.get(0)),this._asElement=!1,this.document=this.root.body?this.root:this.root.ownerDocument,a=a||{},a.nodeName&&a.nodeType)this.nodes.push(a),this.node=a,a={},this._asElement=!0;else if(typeof a=="string")if(a.indexOf("<")===-1)this.nodes=Array.prototype.slice.call(this.root.querySelectorAll(a)),a={},this._asElement=!0;else if(this.settings&&this.settings.content instanceof _)this.append(this.settings.content);else if(this.settings&&typeof this.settings.content=="object")this.append(new _(this.settings.content));else{var s=this._asdom(a);this.nodes=[].slice.call(s.children),this._asElement=!0}a=a||{};var n={tag:"div",props:{}};this.settings=y.extend({},n,a),!this._asElement&&(this.create(),this.setProps())},this.init()};const F=function(a,t){return new _(a,t)};F.module=function(a,t){_.prototype[a]=t};const Y="mw-le-element";window.customElements&&!customElements.get(Y)&&customElements.define(Y,class extends HTMLElement{constructor(){super()}});const u=(a,t)=>(a instanceof Object&&!a.nodeType&&(a=y.extend({},a||{},{tag:a.tag||Y})),F(a,t)),nt=function(a,t){var i={handle:null,element:null,document,helper:!0},e=this,s={};this.on=function(o,r){s[o]?s[o].push(r):s[o]=[r]},this.dispatch=function(o,r){s[o]&&s[o].forEach(function(l){l.call(this,r)})};var n=function(o){e.settings.document.body.style.scrollBehavior="smooth",e.settings.document.defaultView.scrollTo(0,e.settings.document.defaultView.scrollY+o),e.settings.document.body.style.scrollBehavior=""};this.config=function(){this.settings=y.extend({},i,a),this.settings.target||(this.settings.target=this.settings.document.body),this.setElement(this.settings.element),this.dropIndicator=this.settings.dropIndicator},this.setElement=function(o){this.element=u(o).get(0),this.settings.handle||(this.settings.handle=this.settings.element),this.handle=this.settings.handle,this.handle.attr("draggable","true")},this.setTargets=function(o){this.targets=u(o)},this.addTarget=function(o){this.targets.push(o)},this.init=function(){this.config(),this.draggable()},this.helper=function(o){return this._helper||(this._helper=u().get(0),this._helper.className="mw-draggable-helper",this.settings.document.body.appendChild(this._helper)),o==="create"?(this._helper.style.top=o.pageY+"px",this._helper.style.left=o.pageX+"px",this._helper.style.width=e.element.offsetWidth+"px",this._helper.style.height=e.element.offsetHeight+"px",this.settings.document.documentElement.classList.add("le-dragging"),this._helper.style.display="block"):o==="remove"&&this._helper?(this._helper.style.display="none",this.settings.document.documentElement.classList.remove("le-dragging")):this.settings.helper&&o&&(this._helper.style.top=o.pageY+"px",this._helper.style.left=o.pageX+"px",this._helper.style.maxWidth=e.settings.document.defaultView.innerWidth-o.pageX-40+"px",this.settings.document.documentElement.classList.add("le-dragging")),this._helper},this.isDragging=!1,this.dropableService=new $(t),this.dropPosition=st,this.draggable=function(){u(this.settings.target).on("dragleave",function(o){e.dropIndicator.hide()}),u(this.settings.target).on("dragover",function(o){if(e.target=null,e.action=null,o.target!==e.element||!e.element.contains(o.target)){var r=e.dropableService.getTarget(o.target,e.element);if(r&&r!==e.element){const l=e.dropPosition(o,r);l?(e.target=r.target,e.action=l.action,e.dropIndicator.position(e.target,l.action+"-"+l.position)):e.dropIndicator.hide()}else e.dropIndicator.hide();e.isDragging&&(e.dispatch("dragOver",{element:e.element,event:o}),o.preventDefault())}}).on("drop",function(o){e.isDragging&&(o.preventDefault(),e.target&&e.action&&u(e.target)[e.action](e.element),e.dropIndicator.hide(),e.dispatch("drop",{element:e.element,event:o})),e.dropIndicator.hide()}),this.handle.on("dragstart",function(o){e.isDragging=!0,e.element.id||(e.element.id="mw-element-"+new Date().getTime()),e.element.classList.add("mw-element-is-dragged"),o.dataTransfer.setData("text",e.element.id),o.dataTransfer.effectAllowed="move",e.helper("create"),e.dispatch("dragStart",{element:e.element,event:o})}).on("drag",function(o){var r=90,l=5;o.clientY<r&&n(-l),o.clientY>innerHeight-(r+(this._helper?this._helper.offsetHeight+10:0))&&n(l),o.dataTransfer.dropEffect="copy",e.dispatch("drag",{element:e.element,event:o}),e.helper(o)}).on("dragend",function(o){e.isDragging=!1,e.element.classList.remove("mw-element-is-dragged"),e.helper("remove"),e.dispatch("dragEnd",{element:e.element,event:o})})},this.init()},P=function(a){var t={},i=this;this.settings=y.extend({},t,a);const e={};this.on=(r,l)=>{e[r]?e[r].push(l):e[r]=[l]},this.dispatch=(r,l)=>{e[r]&&e[r].forEach(h=>{h.call(this,l)})};var s=!0,n=null;this.getTarget=function(){return n},this.isVisible=function(){return s},this.show=function(){s=!0,this.wrapper.removeClass("mw-handle-item-hidden")},this.hide=function(){s=!1,this.wrapper.addClass("mw-handle-item-hidden")};let o=null;this.setContent=function(r){o&&o.remove(),o=r,this.wrapper.append(o)},this.initDraggable=function(){this.draggable=new nt({handle:this.handle,element:null,helper:!0,dropIndicator:this.settings.dropIndicator,document:this.settings.document,target:this.settings.root,stateManager:this.settings.stateManager,type:this.settings.type},a),this.draggable.on("dragStart",function(){i.wrapper.addClass("mw-handle-item-dragging")}),this.draggable.on("dragEnd",function(){i.wrapper.removeClass("mw-handle-item-dragging")})},this.set=function(r){if(!r){n=null;return}var l=b.offset(r);this.wrapper.css({top:l.top,left:l.left,width:l.width,height:l.height}),this.show(),this.draggable.setElement(r),n!==r&&(n=r,this.dispatch("targetChange",r))},this.createHandle=function(){this.settings.handle?this.handle=this.settings.handle:(this.handle=u({tag:"div",props:{className:"mw-handle-item-handle",contentEditable:!1,draggable:!0}}),this.wrapper.append(this.handle))},this.createWrapper=function(){this.wrapper=u({tag:"div",props:{className:"mw-handle-item "+(this.settings.className||"mw-handle-type-default"),id:this.settings.id||"mw-handle-"+new Date().getTime(),contentEditable:!1}}),this.wrapper.on("mousedown",function(){this.classList.remove("mw-handle-item-mouse-down")}),u(document.body).on("mouseup touchend",function(){i.wrapper.removeClass("mw-handle-item-mouse-down")}),this.settings.document.body.appendChild(this.wrapper.get(0))},this.createWrapper(),this.createHandle(),this.initDraggable(),this.settings.content&&this.setContent(this.settings.content),this.hide()},ot=function(a){a=a||{},this.tools=b;var t=this,i={exceptions:["mw-handle-item"]};this.settings=y.extend({},i,a),this.settings.root.nodeType===9?this.document=this.settings.root:this.document=this.settings.root.ownerDocument,this.body=this.document.body;var e=20,s=function(r){return r%5>=2.5?r/5*5+5:r/5*5},n=function(r,l){r=s(r),l=s(l);for(var h=[],m=r-e,c=r+e,f=l-e,g=l+e;m<c;m+=5)for(;f<=g;f+=5)h.push([m,f]);return h},o=function(r,l){r&&r.parentElement&&l.indexOf(r)===-1&&t.body!==r&&l.push(r)};this.fromEvent=function(r){return t.tools.hasAnyOfClassesOnNodeOrParent(r.target,this.settings.exceptions)?[]:(t.document._test||(t.document._test=document.createElement("div"),t.document._test.style.position="absolute",t.document._test.style.left="10px",t.document._test.style.background="red",t.document._test.style.width="10px",t.document._test.style.height="10px",t.document.body.appendChild(t.document._test)),t.document._test.style.top=r.pageY+"px",this.fromPoint(r.pageX,r.pageY))},this.fromPoint=function(r,l){var h=[];t.document.defaultView.frameElement&&(l-=t.document.defaultView.scrollY);var m=t.document.elementFromPoint(r,l);if(!m)return[];o(m,h);var c=n(r,l);return c.forEach(function(f){o(t.document.elementFromPoint(f[0],f[1]),h)}),h}},at=function(a){return b.matches(a,'.row,[class*="row-"]')},rt=function(a){return b.matches(a,'.col,[class*="col-"]')};let C;const X=function(){return C||(C=document.createElement("div"),C.style.visibility="hidden",C.style.position="absolute",C.style.width="1px",C.style.height="1px",document.body.appendChild(C)),C},k={},lt=function(a){if(!a||a.nodeType===3)return!1;var t=a.nodeName;if(typeof k[t]<"u")return k[t];var i=document.createElement(t);return X().appendChild(i),k[t]=getComputedStyle(i).display==="block",X().removeChild(i),k[t]},ht=(a,t,i)=>{a=a||"*";for(var e=t.querySelectorAll(a),s=0,n=[];s<e.length;s++)!rt(e[s])&&!at(e[s])&&!i.elementAnalyzer.isEdit(e[s])&&lt(e[s])&&n.push(e[s]);return n},ct=a=>{const{backgroundImageHolder:t,editClass:i,moduleClass:e,elementClass:s,allowDrop:n}=a.settings,o=a.root;for(var r=o.querySelectorAll("."+i+"."+t+", ."+i+" ."+t+", ."+i+'[style*="background-image"], .'+i+' [style*="background-image"]'),l=o.querySelectorAll("."+e+a.settings.unEditableModules.join(",."+e)),h=o.querySelectorAll("."+i),m=0,c=0,f=0;m<r.length;m++){var g=r[m];a.elementAnalyzer.isInEdit(g)&&(mw.tools.hasClass(g,e)||mw.tools.addClass(g,i),g.style.backgroundImage||(g.style.backgroundImage="none"))}for(;c<l.length;c++)l[m].classList.remove(e);for(;f<h.length;f++){for(var A=ht(":not(."+s+")",h[f],a),x=0,z=h[f].querySelectorAll("."+n),I=0;I<z.length;I++)z[I].classList.add(s);for(;x<A.length;x++)A[x].classList.contains(e)||a.elementAnalyzer.isInEdit(A[x])&&A[x].classList.add(s)}},dt=function(a){this.handles=a,this.dragging=!1;var t=this;this.get=function(i){return this.handles[i]},this.set=function(i,e){this.get(i).set(e)},this.hide=function(i){i&&this.handles[i]?this.handles[i].hide():this.each(function(e,s){s.hide()})},this.hideAllBut=function(i){this.each(function(e,s){e!==i&&s.hide()})},this.show=function(i){i&&this.handles[i]?this.handles[i].show():this.each(function(e,s){s.show()})},this.each=function(i){if(i){var e;for(e in this.handles)i.call(t,e,this.handles[e])}},this.init=function(){this.each(function(i,e){e.draggable.on("dragStart",function(){t.dragging=!0,t.hideAllBut(i)}),e.draggable.on("dragEnd",function(){t.dragging=!1,e.show()})})},this.init()},ut=function(a){a=a||{};const t={template:"default"};let i={};this.settings=y.extend({},t,a),this._indicator=null;const e={};this.on=function(l,h){e[l]?e[l].push(h):e[l]=[h]},this.dispatch=function(l,h){e[l]&&e[l].forEach(function(m){m.call(this,h)})},this.visible=!1,this.hide=function(){this.visible&&(this._indicator.addClass("mw-drop-indicator-hidden"),this.visible=!1,i={})},this.show=function(){console.log(this.visible),this.visible||this._indicator.removeClass("mw-drop-indicator-hidden"),this.visible=!0};const s=["before-top","prepend-top","after-bottom","append-bottom"],n="mw-drop-indicator-position-",o=s.map(function(l){return n+l});let r=null;this.position=function(l,h){if(!(!l||!h)&&!(i.target===l&&i.position===h)){i.target=l,i.position=h,r!==h&&(this._indicator.removeClass(o),r=h,this._indicator.addClass(n+h));var m=b.offset(l);this._indicator.css({height:m.height,left:m.left,top:m.top,width:m.width}),this.show()}},this.make=function(){this._indicator=u(),this._indicator.html('<div class="mw-drop-indicator-block"><div class="mw-drop-indicator-pin"></div></div>'),this._indicator.addClass("mw-drop-indicator mw-drop-indicator-template-"+this.settings.template),this.hide(),this.settings.document.body.appendChild(this._indicator.get(0))},this.init=function(){this.make()},this.init()},mt=(a,t,i)=>{!a||!t||(a=a.isMWElement?a.get(0):a,a.dataset.tooltip=t,a.title=t,a.dataset.tooltipposition=i||"top-center")},D=function(a){this.options=a||{};var t=this;this._visible=!0,this.isVisible=function(){return this._visible},this.show=function(){this._visible=!0,this.root.addClass("mw-le-handle-menu-visible")},this.hide=function(){this._visible=!1,this.root.removeClass("mw-le-handle-menu-visible")},this.create=function(){this.root=u({props:{className:"mw-le-handle-menu",id:t.options.id||"mw-le-handle-menu-"+new Date().getTime()}}),this.buttonsHolder=u({props:{className:"mw-le-handle-menu-buttons"}}),this.root.append(this.buttonsHolder)};var i,e,s,n=function(){i=u({props:{className:"mw-le-handle-menu-title"}}),e=u({props:{className:"mw-le-handle-menu-title-text"}}),s=u({props:{className:"mw-le-handle-menu-title-icon"}}),i.append(e),i.append(s),t.root.prepend(i),t.title=i},o=null;this.getTarget=function(){return o},this.setTarget=function(r){o=r;for(var l=0;l<this.buttons.length;l++)this.buttons[l].config.onTarget&&this.buttons[l].config.onTarget(r,this.buttons[l].button.get(0),t.options.rootScope)},this.setTitle=function(r,l){e.html(r||""),s.html(l||"")},this.buttons=[],this.buildButtons=function(r,l){l=l||this.buttonsHolder,r=r||this.options.buttons,r.forEach(function(h){l.append(t.button(h))})},this.button=function(r){var l=u({props:{className:"mw-le-handle-menu-button"+(r.className?" "+r.className:"")}}),h={props:{className:"mw-le-handle-menu-button-content"}},m=u(h);if(r.title&&mt(m,r.title),r.icon){var c=u({props:{className:"mw-le-handle-menu-button-icon",innerHTML:r.icon}});m.append(c)}if(r.text){var f=u({props:{className:"mw-le-handle-menu-button-text",innerHTML:r.text}});m.append(f)}if(l.append(m),this.buttons.push({button:l,config:r}),r.menu){var g=u({props:{className:"mw-le-handle-menu-button-sub-menu"}});l.append(g),t.buildButtons(r.menu,g),l.on("click",function(){this.classList.toggle("sub-menu-active")})}else typeof r.action=="function"&&l.on("click",function(){r.action(t.getTarget(),l.get(0),{dialog:t.options.rootScope.dialog,tooltip:t.options.rootScope.tooltip})});return l},this.init=function(){this.create(),n(),this.setTitle(t.options.title,t.options.icon),this.buildButtons(),this.hide()},this.init()},ft=function(a){this.root=u({props:{id:"mw-handle-item-element-root"}}),this.menu=new D({id:"mw-handle-item-element-menu",title:"Element",buttons:[{title:"Settings",text:"",icon:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path d="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z" /></svg>',className:"mw-handle-insert-button",onTarget:function(t,i){},action:function(t){a.dialog({})}},{title:a.lang("Delete"),text:"",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z" /></svg>',className:"mw-handle-insert-button",action:function(t){}}]}),this.menu.show(),this.root.append(this.menu.root)},pt=function(a){this.root=u({props:{id:"mw-handle-item-module-root",contentEditable:!1}}),this.menu=new D({id:"mw-handle-item-element-menu",title:"Module",rootScope:a,buttons:[]}),this.menu.show(),this.root.append(this.menu.root)},gt=(a,t)=>{const i=u({props:{className:"le-dialog-footer"}}),e=u({props:{className:"le-btn le-btn-primary le-dialog-footer-ok",innerHTML:a||"OK"}}),s=u({props:{className:"le-btn le-dialog-footer-cancel"}});return i.append(s),i.append(e),{ok:e,cancel:s,footer:i}};var L,T,R;class G{constructor(t){E(this,T);E(this,L,{});t=t||{};const i={content:null,overlay:!0,closeOnEscape:!0,document,position:"centered",mode:"fixed"};this.settings=Object.assign({},i,t),this.build(),setTimeout(e=>this.open())}on(t,i){d(this,L)[t]?d(this,L)[t].push(i):d(this,L)[t]=[i]}dispatch(t,i){d(this,L)[t]&&d(this,L)[t].forEach(e=>{e.call(this,i)})}build(){this.root=u({props:{className:`le-dialog ${typeof this.settings.position=="string"?this.settings.position:""}`}});var t=u({props:{className:"le-dialog-close"}});t.on("click",()=>{this.remove()}),this.container=u({props:{className:"le-dialog-container"},content:this.settings.content}),this.root.append(t),this.root.append(this.container),this.settings.footer&&this.root.append(this.settings.footer.root||this.settings.footer),this.settings.document.body.appendChild(this.root.get(0)),this.settings.closeOnEscape&&this.settings.document.addEventListener("keydown",N(this,T,R)),this.settings.overlay&&this.overlay()}open(){if(this.settings.position.nodeName&&this.settings.position.ownerDocument===this.settings.document){var t=this.settings.position;t.ownerDocument;var i=t.ownerDocument.defaultView,e=t.getBoundingClientRect(),s=e.top+i.scrollY,n=e.left+t.offsetWidth+i.scrollX,o=this.root.get(0);s+o.offsetHeight>i.innerHeight+i.scrollY&&(s-=s+o.offsetHeight-(i.innerHeight+i.scrollY)),n+o.offsetWidth>i.innerWidth&&(n-=n+o.offsetWidth-i.innerWidth),this.root.css({top:s,left:n,position:this.settings.mode})}this.root.addClass("le-dialog-opened")}remove(){this.root.on("transitionend",()=>{this.root.remove(),this.overlay&&this.overlay.remove()}),this.root.removeClass("le-dialog-opened"),this.settings.closeOnEscape&&this.settings.document.removeEventListener("keydown",N(this,T,R)),this.dispatch("close")}overlay(){this.overlay=u({props:{className:"le-dialog-overlay"}}),this.settings.document.body.appendChild(this.overlay.get(0))}}L=new WeakMap,T=new WeakSet,R=function(t){(t.key==="Escape"||t.keyCode===27)&&this.remove()};const vt=function(a,t){const i=gt(),e=new G({content:a,footer:i,position:"centered"});return i.cancel.on("click",function(){e.remove()}),i.ok.on("click",function(){t&&t.call(),e.remove()}),e},W={},wt=a=>new Promise(t=>{Array.isArray(a)?t(a):typeof a=="string"&&(W[a]?t(W[a]):fetch(a,{mode:"cors"}).then(i=>i.json()).then(i=>{W[a]=i,t(i)}))}),yt=(a,t)=>{const i=u({props:{className:"le-selectable-items-list-item",moduleId:a.id},content:[{props:{className:"le-selectable-items-list-image",style:{backgroundImage:"url("+(a.icon||a.screenshot)+")"}}},{props:{className:"le-selectable-items-list-title",innerHTML:a.name}}]});return i.get(0).__data=a,i},bt=(a,t)=>new Promise(i=>{if(!a||!a.id&&!a.layout_file){i(null);return}const e={ondrop:!0,id:a.id||"module-"+Date.now()};a.module?e["data-module-name"]=a.module:a.type==="layout"&&(e["data-module-name"]="layouts",e.template=a.layout_file);const s={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}};fetch(t,s).then(n=>n.text()).then(n=>i(n))}),Ct=(a,t)=>{const i=u({props:{className:"le-selectable-items-list le-selectable-items-list-type-"+t}});return u({props:{className:"le-selectable-items-list le-selectable-items-list-type-"+t}}),a.forEach(function(e){i.append(yt(e))}),i},Lt=function(a){var t=this;this.root=u({props:{id:"mw-handle-item-layout-root"}}),this.menu=new D({id:"mw-handle-item-layout-menu",title:a.lang("Layout"),rootScope:a,buttons:[{title:a.lang("Settings"),text:"",icon:'<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" width="21" height="21" viewBox="0 0 13.3 15.9" xml:space="preserve"><path d="M8.2,2.4L11,5.1l-8.2,8.2H0v-2.8L8.2,2.4z M11.8,4.3L9,1.6l1.4-1.4C10.5,0.1,10.7,0,10.9,0c0.2,0,0.4,0.1,0.5,0.2l1.7,1.7c0.1,0.1,0.2,0.3,0.2,0.5S13.3,2.8,13.1,3L11.8,4.3z"/><rect y="14.5" width="12" height="1.4"/></svg>',className:"mw-handle-insert-button",menu:[{title:a.lang("Add something"),text:a.lang("Add something"),icon:'<svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10M10,22C9.75,22 9.54,21.82 9.5,21.58L9.13,18.93C8.5,18.68 7.96,18.34 7.44,17.94L4.95,18.95C4.73,19.03 4.46,18.95 4.34,18.73L2.34,15.27C2.21,15.05 2.27,14.78 2.46,14.63L4.57,12.97L4.5,12L4.57,11L2.46,9.37C2.27,9.22 2.21,8.95 2.34,8.73L4.34,5.27C4.46,5.05 4.73,4.96 4.95,5.05L7.44,6.05C7.96,5.66 8.5,5.32 9.13,5.07L9.5,2.42C9.54,2.18 9.75,2 10,2H14C14.25,2 14.46,2.18 14.5,2.42L14.87,5.07C15.5,5.32 16.04,5.66 16.56,6.05L19.05,5.05C19.27,4.96 19.54,5.05 19.66,5.27L21.66,8.73C21.79,8.95 21.73,9.22 21.54,9.37L19.43,11L19.5,12L19.43,13L21.54,14.63C21.73,14.78 21.79,15.05 21.66,15.27L19.66,18.73C19.54,18.95 19.27,19.04 19.05,18.95L16.56,17.95C16.04,18.34 15.5,18.68 14.87,18.93L14.5,21.58C14.46,21.82 14.25,22 14,22H10M11.25,4L10.88,6.61C9.68,6.86 8.62,7.5 7.85,8.39L5.44,7.35L4.69,8.65L6.8,10.2C6.4,11.37 6.4,12.64 6.8,13.8L4.68,15.36L5.43,16.66L7.86,15.62C8.63,16.5 9.68,17.14 10.87,17.38L11.24,20H12.76L13.13,17.39C14.32,17.14 15.37,16.5 16.14,15.62L18.57,16.66L19.32,15.36L17.2,13.81C17.6,12.64 17.6,11.37 17.2,10.2L19.31,8.65L18.56,7.35L16.15,8.39C15.38,7.5 14.32,6.86 13.12,6.62L12.75,4H11.25Z" /></svg>',className:"mw-handle-insert-button"},{title:a.lang("Settings1212"),text:"Do alert",className:"mw-handle-insert-button"}]},{title:a.lang("Clone"),text:"",icon:'<svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg>',className:"mw-handle-insert-button",action:function(i,e,s){var n=document.createElement("div");n.innerHTML=i.outerHTML,u("[id]",n).each(function(){this.id="le-id-"+new Date().getTime()}),u(i).after(n.innerHTML);var o=i.nextElementSibling;mw.reload_module(o,function(){s.statemanager.record({target:mw.tools.firstParentWithClass(i,"edit"),value:parent.innerHTML})})}},{title:a.lang("Move Down"),text:"",icon:'<svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M11,4H13V16L18.5,10.5L19.92,11.92L12,19.84L4.08,11.92L5.5,10.5L11,16V4Z" /></svg>',className:"mw-handle-insert-button",onTarget:function(i,e,s){i.nextElementSibling===null?e.style.display="none":e.style.display=""},action:function(i,e,s){s.handles.get("layout").hide();var n=i.nextElementSibling;if(n){var o=i.getBoundingClientRect(),r=n.getBoundingClientRect(),l=0;o.top<r.top&&(l=-(o.top-r.top)),i.classList.add("mw-le-target-to-animate"),n.classList.add("mw-le-target-to-animate"),i.style.transform="translateY("+l+"px)",n.style.transform="translateY("+-l+"px)",setTimeout(function(){n.parentNode.insertBefore(i,n.nextSibling),i.classList.remove("mw-le-target-to-animate"),n.classList.remove("mw-le-target-to-animate"),i.style.transform="",n.style.transform=""},300)}}},{title:a.lang("Move up"),text:"",icon:'<svg fill="currentColor" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M13,20H11V8L5.5,13.5L4.08,12.08L12,4.16L19.92,12.08L18.5,13.5L13,8V20Z" /></svg>',className:"mw-handle-insert-button",onTarget:function(i,e,s){i.previousElementSibling===null?e.style.display="none":e.style.display=""},action:function(i,e,s){s.handles.get("layout").hide();var n=i.previousElementSibling;if(n){var o=i.getBoundingClientRect(),r=n.getBoundingClientRect(),l=0;o.top>r.top&&(l=-(o.top-r.top)),i.classList.add("mw-le-target-to-animate"),n.classList.add("mw-le-target-to-animate"),i.style.transform="translateY("+l+"px)",n.style.transform="translateY("+-l+"px)",setTimeout(function(){n.parentNode.insertBefore(i,n),i.classList.remove("mw-le-target-to-animate"),n.classList.remove("mw-le-target-to-animate"),i.style.transform="",n.style.transform=""},300)}}},{title:a.lang("Delete"),text:"",icon:'<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path  d="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z" /></svg>',className:"mw-handle-insert-button",action:function(i,e,s){vt("Are you sure",function(){i.remove()})}}]}),this.addButtons=function(){if(a.settings.layouts){var i="Add Layout",e=function(s){wt(a.settings.layouts).then(n=>{const o=Ct(n,"layouts");var r=a.dialog({content:o});u(".le-selectable-items-list-item",o).on("click",function(){bt(this.__data,a.settings.loadModulesURL).then(function(l){var h;s==="top"?h="before":s==="bottom"&&(h="after"),u(t.handle.getTarget())[h](l)}),r.remove()})})};this.plusTop=u({props:{className:"mw-handle-item-layout-plus mw-handle-item-layout-plus-top",innerHTML:a.lang(i)}}),this.plusBottom=u({props:{className:"mw-handle-item-layout-plus mw-handle-item-layout-plus-bottom",innerHTML:a.lang(i)}}),this.plusTop.on("click",function(){e("top")}),this.plusBottom.on("click",function(){e("bottom")}),this.root.append(this.plusTop),this.root.append(this.plusBottom)}},this.menu.show(),this.addButtons(),this.root.append(this.menu.root)},Z={en:{Layout:"Layout","Add layout":"Add layout",Title:"Title",Settings:"Settings",Paragraph:"Paragraph",Text:"Text"},bg:{}},Et=(a,t)=>((!t||!Z[t])&&(t="en"),Z[t][a]||a);class Q{constructor(t){const i=this,e={};this.on=(c,f)=>{e[c]?e[c].push(f):e[c]=[f]},this.dispatch=(c,f)=>{e[c]&&e[c].forEach(g=>{g.call(this,f)})},this.paused=!1;var s={elementClass:"element",backgroundImageHolder:"background-image-holder",cloneableClass:"cloneable",editClass:"edit",stateManager:null,moduleClass:"module",nodrop:"nodrop",allowDrop:"allow-drop",unEditableModules:['[type="template_settings"]'],frameworksClasses:{col:["col","mw-col"]},document,mode:"manual",lang:"en",strict:!0,strictLayouts:!1,viewWindow:window,modules:[{type:"layout",directory:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/",template_dir:"casamia",name:"CLEAN CONTAINER",position:0,layout_file:"skin-1.php",filename:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-1.php",screenshot_file:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-1.jpg",screenshot:"https://unit.microweber.com/userfiles/templates/casamia/modules/layouts/templates/skin-1.jpg",data:"http://asas.com"},{type:"layout",directory:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/",template_dir:"casamia",name:"lang Key",position:0,layout_file:"skin-lang-key.php",filename:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-lang-key.php"}],xlayouts:"https://unit.microweber.com/api/get_layouts_list_json",layouts:[{type:"layout",directory:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/",template_dir:"casamia",name:"CLEAN CONTAINER",position:0,layout_file:"skin-1.php",filename:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-1.php",screenshot_file:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-1.jpg",screenshot:"https://unit.microweber.com/userfiles/templates/casamia/modules/layouts/templates/skin-1.jpg"},{type:"layout",directory:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/",template_dir:"casamia",name:"lang Key",position:0,layout_file:"skin-lang-key.php",filename:"/home/unitmicroweber/public_html/userfiles/templates/casamia/modules/layouts/templates/skin-lang-key.php"}],loadModulesURL:"http://localhost/mw2/module"};this.settings=y.extend({},s,t),this.document=this.settings.document,this.stateManager=this.settings.stateManager,this.lang=function(c){return Et(c,this.settings.lang)},this.settings.root||(this.settings.root=this.settings.document.body),this.root=this.settings.root,this.elementAnalyzer=new $(this.settings),this.dropIndicator=new ut(this.settings);const n=new ft(this);window.moduleHandleContent=new pt(this);const o=new Lt(this);this.dialog=function(c){c||(c={});var f={document:window.top.document,position:moduleHandleContent.menu.getTarget(),mode:"absolute"};i.pause();const g=new G(y.extend({},f,c));return g.on("close",function(){i.play()}),g};var r=this.elementHandle=new P({...this.settings,dropIndicator:this.dropIndicator,content:n.root,handle:n.menu.title,document:this.settings.document,stateManager:this.settings.stateManager});r.on("targetChange",function(c){n.menu.setTarget(c);var f="";c.nodeName==="P"?f=i.lang("Paragraph"):/(H[1-6])/.test(c.nodeName)?f=i.lang("Title")+" "+c.nodeName.replace(/^\D+/g,""):c.nodeName==="IMG"||c.nodeName==="IMAGE"?f=i.lang("Image"):f=i.lang("Text"),n.menu.setTitle(f)}),this.moduleHandle=new P({...this.settings,dropIndicator:this.dropIndicator,content:moduleHandleContent.root,handle:moduleHandleContent.menu.title,document:this.settings.document,stateManager:this.settings.stateManager});var l=this.moduleHandle;this.getModuleQuickSettings=c=>new Promise(f=>{f(mw.quickSettings[c]),this.dispatch("moduleQuickSettings",{module:c})}),l.on("targetChange",function(c){i.getModuleQuickSettings(c.dataset.type).then(function(f){moduleHandleContent.menu.root.remove(),moduleHandleContent.menu=new D({id:"mw-handle-item-element-menu",title:c.dataset.type,rootScope:i,buttons:f?f.mainMenu||[]:[],data:{target:c}}),moduleHandleContent.menu.setTarget(c),moduleHandleContent.menu.show(),moduleHandleContent.root.append(moduleHandleContent.menu.root)})}),this.layoutHandle=new P({...this.settings,dropIndicator:this.dropIndicator,content:o.root,handle:o.menu.title,document:this.settings.document,stateManager:this.settings.stateManager,type:"layout"});var h=this.layoutHandle,m=i.lang("Layout");o.menu.setTitle(m),h.on("targetChange",function(c){o.menu.setTarget(c),o.menu.setTitle(m),i.elementAnalyzer.isEditOrInEdit(c)?(o.plusTop.show(),o.plusBottom.show()):(o.plusTop.hide(),o.plusBottom.hide())}),o.handle=h,moduleHandleContent.handle=l,n.handle=r,this.handles=new dt({element:r,module:l,layout:h}),this.observe=new ot(this.settings),this.init()}play(){this.paused=!1}pause(){this.handles.hide(),this.paused=!0}init(){this.settings.mode==="auto"&&ct(this),u(this.root).on("mousemove touchmove",t=>{if(!this.paused&&t.pageX%2===0){const i=this.observe.fromEvent(t),e=i[0];if(e){const s=this.elementAnalyzer.getType(e);s&&s!=="edit"&&(this.handles.set(s,i[0]),s==="element"?this.handles.hide("module"):s==="module"&&this.handles.hide("element"))}}})}}globalThis.LiveEdit=Q;const _t=()=>{mw.app.get("canvas").getFrame().parentElement;const t=mw.app.get("canvas").getDocument(),i=t.createElement("link");i.rel="stylesheet",i.href=`${mw.settings.site_url}userfiles/modules/microweber/api/liveedit2/css/dist.css`,t.head.prepend(i);const e=new Q({root:t.body,strict:!1,mode:"auto",document:t});mw.app.call("onLiveEditReady"),mw.app.register("liveEdit",e),mw.app.register("state",mw.liveEditState)};var w,H,B;class Nt extends j{constructor(){super(...arguments);E(this,H);E(this,w,{})}call(i,e){for(let s in d(this,w))d(this,w)[s][i]&&N(this,H,B).call(this,i,d(this,w)[s],e)}get(i){return d(this,w)[i]}getModules(){return d(this,w)}register(i,e){let s;typeof e=="function"?s=new e:s=e,d(this,w)[i]=s,N(this,H,B).call(this,"onRegister",s),this.dispatch("$moduleRegistered")}remove(i){let e;if(typeof i=="string"&&(e=i,i=this.get(i)),!e){for(let s in d(this,w))if(d(this,w)[s]===i){e=s;break}}delete d(this,w)[e],N(this,H,B).call(this,"onDestroy",i),this.dispatch("$moduleRemoved")}}w=new WeakMap,H=new WeakSet,B=function(i,e,s){!i||!e||!e[i]||(i=e[i],i(s))};(()=>{mw.app=new Nt;const a=new tt,t=document.getElementById("live-edit-frame-holder");a.mount(t),mw.app.register("canvas",a),a.on("liveEditCanvasLoaded",()=>{new J,_t()})})();
